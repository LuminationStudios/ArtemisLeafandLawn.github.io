<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="theme.css">
<title>Admin Calendar</title>
</head>
<body>
<h1>Artemis Lawn & Leaf - Admin Calendar</h1>
<button id="logoutBtn">Log Out</button>
<div id="calendar"></div>
<div id="eventModal" style="display:none;">
  <input type="text" id="eventTitle" placeholder="Event Title">
  <input type="time" id="eventTime">
  <button id="saveEvent">Save</button>
  <button id="deleteEvent">Delete</button>
</div>
<script>
const PASSWORD = 'artielawn2025';
let loggedIn = false;
while(!loggedIn){
  let pass = prompt('Enter admin password:');
  if(pass === PASSWORD){ loggedIn = true; }
  else { alert('Wrong password'); }
}
let events = JSON.parse(localStorage.getItem('events')) || [];
function saveEvents(){ localStorage.setItem('events', JSON.stringify(events)); }

  // --- Admin Calendar Logic ---
let events = JSON.parse(localStorage.getItem('events')) || [];

// References
const modal = document.getElementById('eventModal');
const titleInput = document.getElementById('eventTitle');
const timeInput = document.getElementById('eventTime');
const saveBtn = document.getElementById('saveEvent');
const deleteBtn = document.getElementById('deleteEvent');
const calendarDiv = document.getElementById('calendar');

let editingIndex = null;

// Create floating "Add Event" button
const addBtn = document.createElement('button');
addBtn.textContent = '+ Add Event';
addBtn.style.position = 'fixed';
addBtn.style.bottom = '20px';
addBtn.style.right = '20px';
addBtn.style.padding = '10px 20px';
addBtn.style.backgroundColor = 'var(--primary-color)';
addBtn.style.color = '#fff';
addBtn.style.border = 'none';
addBtn.style.borderRadius = '10px';
addBtn.style.cursor = 'pointer';
document.body.appendChild(addBtn);

addBtn.onclick = () => openModal();

// Render events as a simple list
function renderCalendar() {
  calendarDiv.innerHTML = '';
  events.forEach((ev, idx) => {
    const div = document.createElement('div');
    div.textContent = `${ev.time} - ${ev.title}`;
    div.style.cursor = 'pointer';
    div.style.margin = '5px 0';
    div.style.padding = '5px';
    div.style.border = '1px solid var(--secondary-color)';
    div.style.borderRadius = '5px';
    div.onclick = () => openModal(idx);
    calendarDiv.appendChild(div);
  });
}

// Open modal for add or edit
function openModal(index = null) {
  editingIndex = index;
  if (index !== null) {
    titleInput.value = events[index].title;
    timeInput.value = events[index].time;
    deleteBtn.style.display = 'inline';
  } else {
    titleInput.value = '';
    timeInput.value = '';
    deleteBtn.style.display = 'none';
  }
  modal.style.display = 'block';
}

// Save event
saveBtn.onclick = () => {
  const ev = { title: titleInput.value, time: timeInput.value };
  if (editingIndex !== null) {
    events[editingIndex] = ev;
  } else {
    events.push(ev);
  }
  localStorage.setItem('events', JSON.stringify(events));
  modal.style.display = 'none';
  renderCalendar();
};

// Delete event
deleteBtn.onclick = () => {
  if (editingIndex !== null) {
    events.splice(editingIndex, 1);
    localStorage.setItem('events', JSON.stringify(events));
    modal.style.display = 'none';
    renderCalendar();
  }
};

// Close modal on outside click
window.onclick = (e) => {
  if (e.target == modal) modal.style.display = 'none';
};

// Initial render
renderCalendar();

</script>
</body>
</html>
